<!-- Modal de Inventario -->
<div class="modal fade" id="modalInventario" tabindex="-1" aria-labelledby="modalInventarioLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header bg-info text-white">
                <h5 class="modal-title" id="modalInventarioLabel">
                    <i class="bi bi-box-seam me-2"></i>Consultar Inventario
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-0">
                <!-- Filtros de búsqueda -->
                <div class="bg-light p-3 border-bottom">
                    <div class="row g-3">
                        <div class="col-md-4">
                            <div class="input-group">
                                <span class="input-group-text">
                                    <i class="bi bi-search"></i>
                                </span>
                                <input type="text" 
                                       class="form-control" 
                                       id="busquedaInventarioModal" 
                                       placeholder="Buscar por nombre o descripción...">
                            </div>
                        </div>
                        <div class="col-md-3">
                            <select class="form-select" id="categoriaInventarioModal">
                                <option value="todas">Todas las categorías</option>
                                <option value="llantas">Llantas</option>
                                <option value="accesorios">Accesorios</option>
                                <option value="servicios">Servicios</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <select class="form-select" id="stockInventarioModal">
                                <option value="">Todo el stock</option>
                                <option value="disponible">Con stock disponible</option>
                                <option value="agotado">Sin stock</option>
                                <option value="bajo">Stock bajo</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <button type="button" 
                                    class="btn btn-outline-secondary w-100" 
                                    id="btnLimpiarFiltrosInventario">
                                <i class="bi bi-eraser me-1"></i>Limpiar
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Loading -->
                <div id="inventarioModalLoading" class="d-none">
                    <div class="text-center py-5">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Cargando...</span>
                        </div>
                        <p class="mt-2 text-muted">Cargando productos del inventario...</p>
                    </div>
                </div>

                <!-- Contenido del modal -->
                <div id="inventarioModalContent" class="p-3" style="min-height: 400px;">
                    <!-- Tabla de productos -->
                    <div class="table-responsive">
                        <table id="tablaInventarioModal" class="table table-hover table-striped">
                            <thead class="table-dark">
                                <tr>
                                    <th class="sortable" data-column="nombre" style="cursor: pointer;">
                                        Producto
                                        <i class="bi bi-arrow-down-up ms-1"></i>
                                    </th>
                                    <th class="sortable" data-column="medida" style="cursor: pointer;">
                                        Medida
                                        <i class="bi bi-arrow-down-up ms-1"></i>
                                    </th>
                                    <th class="sortable" data-column="descripcion" style="cursor: pointer;">
                                        Descripción
                                        <i class="bi bi-arrow-down-up ms-1"></i>
                                    </th>
                                    <th class="sortable" data-column="stock" style="cursor: pointer; width: 100px;">
                                        Stock
                                        <i class="bi bi-arrow-down-up ms-1"></i>
                                    </th>
                                    <th class="sortable" data-column="precioEfectivo" style="cursor: pointer; width: 120px;">
                                        Precio Efectivo
                                        <i class="bi bi-arrow-down-up ms-1"></i>
                                    </th>
                                    <th class="sortable" data-column="precioTarjeta" style="cursor: pointer; width: 120px;">
                                        Precio Tarjeta
                                        <i class="bi bi-arrow-down-up ms-1"></i>
                                    </th>
                                    <th style="width: 120px;">Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="inventarioModalProductos">
                                <!-- Los productos se cargarán dinámicamente aquí -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="bi bi-x-circle me-1"></i>Cerrar
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal de Detalles del Producto -->
<div class="modal fade" id="modalDetallesProducto" tabindex="-1" aria-labelledby="modalDetallesProductoLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-light">
                <h5 class="modal-title" id="modalDetallesProductoLabel">Detalles del Producto</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="carouselProductoImagenes" class="carousel slide" data-bs-ride="carousel">
                    <div class="carousel-inner" id="carouselInner">
                        <!-- Las imágenes del producto se cargarán aquí dinámicamente -->
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#carouselProductoImagenes" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Anterior</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#carouselProductoImagenes" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Siguiente</span>
                    </button>
                </div>
                <div id="detallesProductoContent">
                    <!-- Otros detalles del producto (nombre, descripción, precio, etc.) se cargarán aquí dinámicamente -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

<script>
    // Function to show product details in the modal
    function mostrarDetallesProducto(producto) {
        // Clear existing content in the carousel and details section
        document.getElementById('carouselInner').innerHTML = '';
        document.getElementById('detallesProductoContent').innerHTML = '';

        // Product images (assuming producto.imagenes is an array of image URLs)
        if (producto.imagenes && producto.imagenes.length > 0) {
            producto.imagenes.forEach((imagen, index) => {
                const carouselItem = document.createElement('div');
                carouselItem.classList.add('carousel-item');
                if (index === 0) {
                    carouselItem.classList.add('active');
                }

                const img = document.createElement('img');
                img.src = imagen;
                img.classList.add('d-block', 'w-100');
                img.alt = `Imagen ${index + 1}`;

                carouselItem.appendChild(img);
                document.getElementById('carouselInner').appendChild(carouselItem);
            });

            // Initialize carousel if more than one image
            if (producto.imagenes.length > 1) {
                const carousel = new bootstrap.Carousel(document.getElementById('carouselProductoImagenes'));
            }
        } else {
            // If no images, display a placeholder or message
            document.getElementById('carouselInner').innerHTML = '<p>No hay imágenes disponibles.</p>';
        }

        // Populate other product details
        let detallesHTML = `
            <h4>${producto.nombre}</h4>
            <p>${producto.descripcion}</p>
            <p>Precio: ${producto.precioEfectivo}</p>
            <p>Stock: ${producto.stock}</p>
            <!-- Add more details as needed -->
        `;
        document.getElementById('detallesProductoContent').innerHTML = detallesHTML;

        // Show the modal
        const modalDetalles = new bootstrap.Modal(document.getElementById('modalDetallesProducto'));
        modalDetalles.show();
    }

    // Attach event listeners to "Ver detalles" buttons
    document.addEventListener('DOMContentLoaded', () => {
        const botonesVerDetalles = document.querySelectorAll('.ver-detalles-btn');
        botonesVerDetalles.forEach(boton => {
            boton.addEventListener('click', function() {
                const productoId = this.dataset.productoId;
                // Fetch product details based on productoId (replace with your actual data fetching logic)
                const producto = obtenerDetallesDelProducto(productoId); // Implement this function
                mostrarDetallesProducto(producto);
            });
        });
    });

    // Dummy function to simulate fetching product details (replace with your actual implementation)
    function obtenerDetallesDelProducto(productoId) {
        // Replace this with your actual data fetching logic
        // This is just a placeholder for demonstration purposes
        return {
            id: productoId,
            nombre: 'Producto de Ejemplo',
            descripcion: 'Descripción del producto de ejemplo.',
            precioEfectivo: 199.99,
            stock: 50,
            imagenes: [
                'https://via.placeholder.com/350x150',
                'https://via.placeholder.com/350x150/007bff/ffffff',
                'https://via.placeholder.com/350x150/28a745/ffffff'
            ]
        };
    }
</script>