
@model Tuco.Clases.DTOs.Inventario.ProductoDTO
@{
    ViewData["Title"] = Model?.NombreProducto ?? "Detalle del Producto";
    Layout = "~/Views/Shared/_Layout.cshtml";

        <link rel="stylesheet" href="~/css/views/public/detalleProducto.css">

}

<div class="detalle-producto-publico-container">
    @if (Model != null)
    {
        <!-- Breadcrumb -->
        <div class="container mt-3">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="@Url.Action("Index", "Home")">Inicio</a></li>
                    <li class="breadcrumb-item"><a href="@Url.Action("Productos", "Public")">Productos</a></li>
                    <li class="breadcrumb-item active" aria-current="page">@Model.NombreProducto</li>
                </ol>
            </nav>
        </div>

        <div class="container py-4">
            <div class="row">
                <!-- Galería de Imágenes -->
                <div class="col-lg-6 mb-4">
                    <div class="galeria-producto">
                        @if (Model.Imagenes?.Any() == true)
                        {
                            <!-- Imagen Principal -->
                            <div class="imagen-principal-container">
                                <img id="imagenPrincipal" 
                                     src="@Model.Imagenes.First().UrlImagen" 
                                     alt="@Model.NombreProducto" 
                                     class="imagen-principal"
                                     data-bs-toggle="modal" 
                                     data-bs-target="#modalImagenGrande">
                                <div class="zoom-indicator">
                                    <i class="fas fa-search-plus"></i>
                                </div>
                            </div>

                            @if (Model.Imagenes.Count > 1)
                            {
                                <!-- Miniaturas -->
                                <div class="miniaturas-container">
                                    @for (int i = 0; i < Model.Imagenes.Count; i++)
                                    {
                                        <div class="miniatura @(i == 0 ? "active" : "")"
                                             data-imagen="@Model.Imagenes[i].UrlImagen"
                                             onclick="cambiarImagenPrincipal('@Model.Imagenes[i].UrlImagen', this)">
                                            <img src="@Model.Imagenes[i].UrlImagen" alt="Vista @(i + 1)">
                                        </div>
                                    }
                                </div>
                            }
                        }
                        else
                        {
                            <div class="sin-imagen-detalle">
                                <i class="fas fa-image"></i>
                                <p>Sin imagen disponible</p>
                            </div>
                        }
                    </div>
                </div>

                <!-- Información del Producto -->
                <div class="col-lg-6">
                    <div class="info-producto">
                        <h1 class="titulo-producto">@Model.NombreProducto</h1>
                        
                        <!-- Precio -->
                        <div class="precio-principal">
                            <span class="precio-valor">₡@Model.Precio?.ToString("N0")</span>
                            @if (Model.Precio > 50000)
                            {
                                <span class="precio-cuotas">o desde ₡@((Model.Precio / 6)?.ToString("N0")) en 6 cuotas</span>
                            }
                        </div>

                        <!-- Stock -->
                        <div class="stock-disponible">
                            <i class="fas fa-check-circle text-success me-2"></i>
                            <span class="fw-bold">@Model.CantidadEnInventario unidades disponibles</span>
                        </div>

                        @if (Model.Llanta != null)
                        {
                            var llanta = Model.Llanta;
                            <!-- Especificaciones de Llanta -->
                            <div class="especificaciones-llanta">
                                <h3 class="h5 mb-3">
                                    <i class="fas fa-cog me-2"></i>Especificaciones
                                </h3>
                                <div class="row g-3">
                                    @if (llanta.Ancho.HasValue && !string.IsNullOrEmpty(llanta.Diametro))
                                    {
                                        <div class="col-6">
                                            <div class="spec-item">
                                                <label>Medida:</label>
                                                <span class="spec-value">
                                                    @if (llanta.Perfil.HasValue && llanta.Perfil.Value > 0)
                                                    {
                                                        @($"{llanta.Ancho}/{llanta.Perfil}/R{llanta.Diametro}")
                                                    }
                                                    else
                                                    {
                                                        @($"{llanta.Ancho}/R{llanta.Diametro}")
                                                    }
                                                </span>
                                            </div>
                                        </div>
                                    }
                                    @if (!string.IsNullOrEmpty(llanta.Marca))
                                    {
                                        <div class="col-6">
                                            <div class="spec-item">
                                                <label>Marca:</label>
                                                <span class="spec-value">@llanta.Marca</span>
                                            </div>
                                        </div>
                                    }
                                    @if (!string.IsNullOrEmpty(llanta.Modelo))
                                    {
                                        <div class="col-6">
                                            <div class="spec-item">
                                                <label>Modelo:</label>
                                                <span class="spec-value">@llanta.Modelo</span>
                                            </div>
                                        </div>
                                    }
                                    @if (!string.IsNullOrEmpty(llanta.TipoTerreno))
                                    {
                                        <div class="col-6">
                                            <div class="spec-item">
                                                <label>Tipo:</label>
                                                <span class="spec-value">@llanta.TipoTerreno</span>
                                            </div>
                                        </div>
                                    }
                                    
                                </div>
                            </div>
                        }

                        @if (!string.IsNullOrEmpty(Model.Descripcion))
                        {
                            <!-- Descripción -->
                            <div class="descripcion-producto">
                                <h3 class="h5 mb-3">
                                    <i class="fas fa-info-circle me-2"></i>Descripción
                                </h3>
                                <p class="descripcion-texto">@Model.Descripcion</p>
                            </div>
                        }

                        <!-- Acciones -->
                        <div class="acciones-producto">
                            <a href="tel:+50689166180" class="btn btn-success btn-lg w-100 mb-3">
                                <i class="fas fa-phone me-2"></i>
                                Llamar para Consultar
                            </a>
                            <a href="https://wa.me/50689166180?text=Hola, me interesa el producto: @Uri.EscapeDataString(Model.NombreProducto)" 
                               target="_blank" 
                               class="btn btn-outline-success w-100 mb-3">
                                <i class="fab fa-whatsapp me-2"></i>
                                Consultar por WhatsApp
                            </a>
                            <a href="@Url.Action("Productos", "Public")" class="btn btn-outline-primary w-100">
                                <i class="fas fa-arrow-left me-2"></i>
                                Volver a Productos
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal para Imagen Grande -->
        <div class="modal fade" id="modalImagenGrande" tabindex="-1">
            <div class="modal-dialog modal-lg modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header border-0">
                        <h5 class="modal-title">@Model.NombreProducto</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body text-center p-0">
                        <img id="imagenModalGrande"
                             src="@(Model.Imagenes?.FirstOrDefault()?.UrlImagen ?? "/images/no-image.png")"
                             alt="@Model.NombreProducto" 
                             class="w-100">
                    </div>
                </div>
            </div>
        </div>
    }
    else
    {
        <div class="container py-5">
            <div class="text-center">
                <i class="fas fa-exclamation-triangle fa-3x text-warning mb-3"></i>
                <h2>Producto no encontrado</h2>
                <p class="lead">El producto que buscas no está disponible.</p>
                <a href="@Url.Action("Productos", "Public")" class="btn btn-primary">
                    <i class="fas fa-arrow-left me-2"></i>
                    Volver a Productos
                </a>
            </div>
        </div>
    }
</div>


@section Scripts {
    <script src="~/js/views/public/detalleProducto.js"></script>
}
