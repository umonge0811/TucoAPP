@page "/login"

<h3>Iniciar Sesión</h3>

<div class="login-container">
    <div>
        <label>Correo Electrónico:</label>
        <input @bind="email" type="email" placeholder="Ingresa tu correo" />

        <label>Contraseña:</label>
        <input @bind="password" type="password" placeholder="Ingresa tu contraseña" />

        @if (!string.IsNullOrEmpty(errorMessage))
        {
            <div class="error">@errorMessage</div>
        }

        <button @onclick="OnLoginClick" disabled="@isLoading">
            @if (isLoading)
            {
                <span>Cargando...</span>
            }
            else
            {
                <span>Iniciar Sesión</span>
            }
        </button>
    </div>
</div>

@code {
    private string email = string.Empty;
    private string password = string.Empty;
    private string errorMessage = string.Empty;
    private bool isLoading = false;

    
    private async Task OnLoginClick()
    {
        isLoading = true;
        errorMessage = string.Empty;

        try
        {
            // // Llamar al servicio para iniciar sesión
            // var result = await ApiService.LoginAsync(email, password);

            // if (result.IsSuccess)
            // {
            //     // Guardar el token en SecureStorage
            //     await SecureStorage.Default.SetAsync("AuthToken", result.Token);

            //     // Redirigir a la página principal
            //     NavigationManager.NavigateTo("/");
            // }
            // else
            // {
            //     errorMessage = result.ErrorMessage;
            // }
        }
        catch (Exception ex)
        {
            errorMessage = "Ocurrió un error inesperado.";
        }
        finally
        {
            isLoading = false;
        }
    }
}
